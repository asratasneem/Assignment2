# Assignment2
Here's a README file incorporating the steps you've outlined in detail, suitable for your project:

---

# README for Transcriptome Analysis of SARS-CoV-2 Infection

## Project Overview
This project involves analyzing transcriptomic changes in human respiratory cells infected with SARS-CoV-2 compared to mock control cells. Differential gene expression is assessed across two time points (24 H and 72 H) and Gene Ontology (GO) enrichment analysis is performed to understand the biological processes affected by the infection.

### Directory Structure
- **A2** (main directory)
  - **aligned_reads**: Contains SAM and BAM files of aligned reads.
  - **counts**: Contains the gene count file generated by featureCounts.
  - **fastqc_reports**: Stores quality control reports from FastQC and MultiQC.
  - **genome**: Stores the reference genome files and annotations.
  - **hisat2_index**: Stores the HISAT2 index files.
  - **Raw_data**: Contains the raw downloaded FASTQ files.
  - **trimmed_reads**: Contains quality-trimmed FASTQ files.

---

## Step-by-Step Guide

### Step 1: Set up Environment and Directory Structure on Quartz HPC

1. **Connect to Quartz HPC**:
   ```bash
   ssh asrashai@Quartz.uits.iu.edu
   ```

2. **Set up directories**:
   ```bash
   mkdir -p /N/u/asrashai/Quartz/A2/{aligned_reads,counts,fastqc_reports,genome,hisat2_index,Raw_data,trimmed_reads}
   ```

3. **Define Directory Paths**:
   ```bash
   TRIM_DIR="/N/u/asrashai/Quartz/A2/trimmed_reads"
   ALIGNED_READS="/N/u/asrashai/Quartz/A2/aligned_reads"
   COUNTS_DIR="/N/u/asrashai/Quartz/A2/counts"
   FASTQC_REPORTS="/N/u/asrashai/Quartz/A2/fastqc_reports"
   GENOME_DIR="/N/u/asrashai/Quartz/A2/genome"
   HISAT2_INDEX="/N/u/asrashai/Quartz/A2/hisat2_index"
   DATA_DIR="/N/u/asrashai/Quartz/A2/Raw_data"
   ```

### Step 2: Data Download

1. **Download raw data** (replace with your specific SRA IDs):
   ```bash
   ACCESSION_IDS=("SRR22269883" "SRR22269882" "SRR22269881" "SRR22269880" "SRR22269879" "SRR22269878" "SRR22269877" "SRR22269876" "SRR22269875" "SRR22269874" "SRR22269873" "SRR22269872")

   mkdir -p $DATA_DIR
   for SRA_ID in "${ACCESSION_IDS[@]}"; do
       prefetch $SRA_ID -O $DATA_DIR
       fasterq-dump $DATA_DIR/$SRA_ID -O $DATA_DIR
   done
   ```

### Step 3: Quality Control with FastQC

1. **Run FastQC on raw data**:
   ```bash
   mkdir -p $FASTQC_REPORTS
   fastqc $DATA_DIR/*.fastq -o $FASTQC_REPORTS
   ```

2. **Install and run MultiQC** (for summarizing QC reports):
   ```bash
   cd /N/u/asrashai/Quartz/installations
   pip install multiqc
   export PATH="/N/u/asrashai/Quartz/.local/bin:$PATH"
   multiqc $FASTQC_REPORTS -o $FASTQC_REPORTS
   ```

### Step 4: Trim Reads with Trim Galore

1. **Install Trim Galore**:
   ```bash
   conda install -c bioconda trim-galore
   ```

2. **Trim reads**:
   ```bash
   mkdir -p $TRIM_DIR
   trim_galore --quality 20 --length 30 -o $TRIM_DIR $DATA_DIR/*.fastq
   ```

3. **Run FastQC on trimmed reads**:
   ```bash
   mkdir -p $FASTQC_REPORTS/trimmed
   fastqc $TRIM_DIR/*.fq -o $FASTQC_REPORTS/trimmed
   ```

### Step 5: Download and Index Reference Genome

1. **Download reference genome** and annotations (example using STAR):
   ```bash
   wget -P $HISAT2_INDEX http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/Homo_sapiens/UCSC/hg38/Homo_sapiens_UCSC_hg38.tar.gz
   tar -xzf $HISAT2_INDEX/Homo_sapiens_UCSC_hg38.tar.gz -C $HISAT2_INDEX
   ```

2. **Build HISAT2 index**:
   ```bash
   hisat2-build $GENOME_DIR/hg38.fa $HISAT2_INDEX/hg38_hisat2_index
   ```

### Step 6: Align Reads with HISAT2

1. **Align trimmed reads** to the reference genome:
   ```bash
   mkdir -p $ALIGNED_READS
   for SRA_ID in "${ACCESSION_IDS[@]}"; do
       hisat2 -p 4 -x $HISAT2_INDEX/hg38_hisat2_index -U $TRIM_DIR/${SRA_ID}_trimmed.fq -S $ALIGNED_READS/${SRA_ID}.sam
   done
   ```

2. **Convert SAM to BAM, sort, and index**:
   ```bash
   for file in $ALIGNED_READS/*.sam; do
       samtools view -Sb $file | samtools sort -o ${file%.sam}_sorted.bam
       samtools index ${file%.sam}_sorted.bam
   done
   ```

### Step 7: Quantification of Gene Counts with featureCounts

1. **Run featureCounts**:
   ```bash
   featureCounts -T 4 -a $GENOME_DIR/Homo_sapiens.GRCh38.106.gtf -o $COUNTS_DIR/gene_counts.txt $ALIGNED_READS/*_sorted.bam
   ```

2. **Download gene counts file** to your local machine:
   ```bash
   scp asrashai@Quartz.uits.iu.edu:/N/u/asrashai/Quartz/A2/counts/gene_counts.txt "C:\Users\asra tasneem\OneDrive\Desktop\gene_counts"
   ```

### Step 8: Differential Expression Analysis and GO Enrichment in R

1. **Load necessary libraries in R**:
   ```R
   library(DESeq2)
   library(edgeR)
   library(clusterProfiler)
   library(org.Hs.eg.db)
   library(ggplot2)
   ```

2. **Prepare data**:
   ```R
   counts <- read.table("gene_counts.txt", header=TRUE, row.names=1)
   sample_info <- read.csv("assignment_2_info.csv", header=TRUE)
   ```

3. **Differential Expression Analysis using EdgeR or DESeq2** (choose your preferred method).

4. **Visualize Differentially Expressed Genes** with volcano plots.

5. **Perform GO Enrichment Analysis**:
   ```R
   go_enrichment <- enrichGO(gene=genes_of_interest, OrgDb=org.Hs.eg.db, ont="BP", pAdjustMethod="BH", pvalueCutoff=0.05)
   barplot(go_enrichment, showCategory=10) + ggtitle("Top 10 Enriched GO Terms")
   ```

6. **Save Results**:
   ```R
   write.csv(go_enrichment, file="GO_Enrichment_Results.csv", row.names=FALSE)
   ```

---

This README provides a structured approach from setting up the HPC environment to completing differential expression analysis and GO enrichment, ensuring reproducibility and clarity in the workflow.
